/*
 RequireJS order 1.0.5 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

(function(){function k(a){var b=a.currentTarget||a.srcElement,c;if(a.type==="load"||l.test(b.readyState)){a=b.getAttribute("data-requiremodule"),j[a]=!0;for(a=0;c=g[a];a++){if(!j[c.name])break;c.req([c.name],c.onLoad)}a>0&&g.splice(0,a),setTimeout(function(){b.parentNode.removeChild(b)},15)}}function m(a){var b,c;a.setAttribute("data-orderloaded","loaded");for(a=0;c=h[a];a++){if(!(b=i[c])||b.getAttribute("data-orderloaded")!=="loaded")break;delete i[c],require.addScriptToDom(b)}a>0&&h.splice(0,a)}var f=typeof document!="undefined"&&typeof window!="undefined"&&document.createElement("script"),n=f&&(f.async||window.opera&&Object.prototype.toString.call(window.opera)==="[object Opera]"||"MozAppearance"in document.documentElement.style),o=f&&f.readyState==="uninitialized",l=/^(complete|loaded)$/,g=[],j={},i={},h=[],f=null;define("order",{version:"1.0.5",load:function(a,b,c,e){var d;b.nameToUrl?(d=b.nameToUrl(a,null),require.s.skipAsync[d]=!0,n||e.isBuild?b([a],c):o?(e=require.s.contexts._,!e.urlFetched[d]&&!e.loaded[a]&&(e.urlFetched[d]=!0,require.resourcesReady(!1),e.scriptCount+=1,d=require.attach(d,e,a,null,null,m),i[a]=d,h.push(a)),b([a],c)):b.specified(a)?b([a],c):(g.push({name:a,req:b,onLoad:c}),require.attach(d,null,a,k,"script/cache"))):b([a],c)}})})(),define("map",["animatedComponent","signals","order!jVectorMap","order!usa-en"],function(AnimatedComponent,signals,mapTemplate){return AnimatedComponent.$extend({__init__:function(container,basemap){var self=this;this.$super(),this.container=container,this.regionClicked=new signals.Signal,this.markerClicked=new signals.Signal,this.mapContainer=$("#mapContainer",this.container),this.legendContainer=$("#map_legend",this.container),this.titleContainer=$("#mapTitle",this.container),this.titleContainer.length==0&&(this.titleContainer=$('<h2 id="mapTitle"></h2>').appendTo(this.container)),this.mapContainer.length==0&&(this.mapContainer=$('<div id="mapContainer"></div>').appendTo(this.container)),this.legendContainer.length==0&&(this.legendContainer=$('<div id="map_legend"></div>').appendTo(this.container)),this.counts=null,this.map=null,this.colors={},this.basemap=basemap==null?"usa_en":basemap,this.options={animation:{callback:function(iteration){this.colors?this.worldMap.series.regions[0].setValues(this.getCurrentColors()):this.worldMap.series.regions&&this.worldMap.series.regions.length>0?this.worldMap.series.regions[0].setValues(this.getCurrentCounts()):this.worldMap.series.markers&&this.worldMap.series.markers.length>0&&this.worldMap.series.markers[0].setValues(this.getCurrentCounts())}},map:this.basemap,normalizeFunction:"polynomial",hoverOpacity:.7,hoverColor:!1,backgroundColor:"white",dataPrecision:0}},play:function(loop,stepSize){this.$super(loop,stepSize)},update:function(counts,title,options){var self=this;typeof options!="undefined"&&typeof options.map!="undefined"&&(this.basemap=options.map,this.options.map=options.map),this.counts=$.map(counts instanceof Array?counts:[counts],function(count){var newCount={};for(var key in count)count.hasOwnProperty(key)&&(jvm.WorldMap.maps[self.basemap].paths.hasOwnProperty(key.toUpperCase())?newCount[key.toUpperCase()]=count[key]:jvm.WorldMap.maps[self.basemap].paths.hasOwnProperty(key.toLowerCase())?newCount[key.toLowerCase()]=count[key]:newCount[key]=count[key]);return newCount}),this.options=$.extend(this.options||{},options),this.$super($.extend(!0,this.animation,this.options.animation,{maxIteration:counts.length-1})),this.setTitle(title),this.calculateMinMax(),typeof this.assignColors=="function"&&this.assignColors(),this.createLegend(),this.setContainerHeight(),this.createMap()},setContainerHeight:function(){this.mapContainer.height(this.mapContainer.parent().height()-(this.titleContainer.outerHeight(!0)+this.legendContainer.outerHeight(!0)+parseInt(this.mapContainer.css("paddingTop"))+parseInt(this.mapContainer.css("paddingBottom"))+10))},calculateMinMax:function(){this.min=this.max=null;for(var i=0;i<this.counts.length;i++)for(var state in this.counts[i])this.counts[i].hasOwnProperty(state)&&(this.min=this.min==null||this.counts[i][state]<this.min?this.counts[i][state]:this.min,this.max=this.max==null||this.counts[i][state]>this.max?this.counts[i][state]:this.max);this.min!==null&&(this.min=parseFloat(Highcharts.numberFormat(this.min,this.options.dataPrecision,".",""))),this.max!==null&&(this.max=parseFloat(Highcharts.numberFormat(this.max,this.options.dataPrecision,".","")))},setTitle:function(title){this.titleContainer.text(title)},createRegionOps:function(){return[{values:this.colors?this.getCurrentColors():this.getCurrentCounts(),min:this.min,max:this.max,scale:this.colors?void 0:this.$class.palette}]},createMarkerOps:function(){return this.options.markers?[{values:this.colors?this.getCurrentColors():this.getCurrentCounts(),min:this.min,max:this.max,scale:this.colors?void 0:this.$class.palette}]:null},createMap:function(){var self=this;this.worldMap&&this.worldMap.remove(),this.regionOps=this.createRegionOps(),this.markerOps=this.createMarkerOps();var series={};this.regionOps&&(series.regions=this.regionOps),this.markerOps&&(series.markers=this.markerOps),this.mapContainer.empty(),this.map=$('<div style="height:100%;width:100%;" class="map_inside_container"></div>').appendTo(this.mapContainer).vectorMap($.extend(!0,{regionStyle:{initial:{fill:"#CCCCCC","fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":1},hover:{"fill-opacity":.8},selected:{fill:"yellow"}},series:series,onRegionClick:function(event,code){self.regionClicked.dispatch(code.toUpperCase(),event)},onMarkerClick:function(event,code){self.markerClicked.dispatch(self.options.markers[code],event)},zoomOnScroll:!1},this.options)),this.worldMap=this.mapContainer.find(".jvectormap-container").data("mapObject")},createLegend:function(buckets,colors){},getCurrentColors:function(){var regions={};return $.each(jvm.WorldMap.maps[this.basemap].paths,function(key,value){regions[key]=""}),$.extend(regions,this.colors[this.animation.iteration])},getCurrentCounts:function(){return this.counts[this.animation.iteration]},destroy:function(){this.worldMap&&this.worldMap.remove(),this.mapContainer.empty(),this.legendContainer.empty(),this.titleContainer.empty()},assignColors:function(counts,buckets,palette){},exportMap:function(fileType){if(!window.SVGAngle)throw"SVG not supported";var mapBackground="white",svg=$(".jvectormap-container").html(),newSvg=$(".jvectormap-container").html(),mapHeight=$(".jvectormap-container").find("svg").attr("height");mapHeight=parseInt(mapHeight)+20;var heightI=svg.indexOf("height");heightI=svg.indexOf('"',heightI);var heightIe=svg.indexOf('"',heightI+1);svg=svg.slice(0,heightI+1)+mapHeight+svg.slice(heightIe),svg=svg.replace(/<div[^<]+<\/div>/gi,""),svg=svg.replace(/<svg /gi,'<svg xmlns="http://www.w3.org/2000/svg"  version="1.1" '),svg=svg.replace(/<g><\/g>/gi,""),svg=svg.replace(/<g/,'<rect x="0" y="0" width="100%" height="100%" fill="'+mapBackground+'"></rect><g'),svg=svg.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/isTracker="[^"]+"/g,"").replace(/url\([^#]+#/g,"url(#").replace(/&nbsp;/g," ").replace(/&shy;/g,"­").replace(/id=([^" >]+)/g,'id="$1"').replace(/class=([^" ]+)/g,'class="$1"').replace(/ transform /g," ").replace(/:(path|rect)/g,"$1").replace(/style="([^"]+)"/g,function(s){return s.toLowerCase()}),svg=svg.replace(/(url\(#highcharts-[0-9]+)&quot;/g,"$1").replace(/&quot;/g,"'"),svg.match(/ xmlns="/g)&&svg.match(/ xmlns="/g).length===2&&(svg=svg.replace(/xmlns="[^"]+"/,""));var export_url="/global/scripts/jquery/highcharts/exporting-server/index.cfm",type="";switch(fileType){case"svg":type="image/svg+xml";break;case"pdf":type="application/pdf";break;case"png":default:type="image/png"}String.prototype.replaceAll=function(search,replace){return replace?this.replace(new RegExp("["+search+"]","g"),replace):this};var hiddenForm=$('<form action="'+export_url+'" method="POST">'+'<input type="hidden" name="svg" id="hiddensvg">'+'<input type="hidden" name="type" value="'+type+'">'+'<input type="hidden" name="filename" value="map_of_'+this.titleContainer.text().replaceAll(":",",").replaceAll(" ","_")+'">'+"</form>");$("body").append(hiddenForm),hiddenForm.find("input[id=hiddensvg]").val(svg),hiddenForm.submit(),hiddenForm.remove()},__classvars__:{palette:["#7ce3ff","#4cc9ff","#0196d8","#00628c","#00355b"]}})})