/*
 RequireJS order 1.0.5 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

(function(){function k(a){var b=a.currentTarget||a.srcElement,c;if(a.type==="load"||l.test(b.readyState)){a=b.getAttribute("data-requiremodule"),j[a]=!0;for(a=0;c=g[a];a++){if(!j[c.name])break;c.req([c.name],c.onLoad)}a>0&&g.splice(0,a),setTimeout(function(){b.parentNode.removeChild(b)},15)}}function m(a){var b,c;a.setAttribute("data-orderloaded","loaded");for(a=0;c=h[a];a++){if(!(b=i[c])||b.getAttribute("data-orderloaded")!=="loaded")break;delete i[c],require.addScriptToDom(b)}a>0&&h.splice(0,a)}var f=typeof document!="undefined"&&typeof window!="undefined"&&document.createElement("script"),n=f&&(f.async||window.opera&&Object.prototype.toString.call(window.opera)==="[object Opera]"||"MozAppearance"in document.documentElement.style),o=f&&f.readyState==="uninitialized",l=/^(complete|loaded)$/,g=[],j={},i={},h=[],f=null;define("order",{version:"1.0.5",load:function(a,b,c,e){var d;b.nameToUrl?(d=b.nameToUrl(a,null),require.s.skipAsync[d]=!0,n||e.isBuild?b([a],c):o?(e=require.s.contexts._,!e.urlFetched[d]&&!e.loaded[a]&&(e.urlFetched[d]=!0,require.resourcesReady(!1),e.scriptCount+=1,d=require.attach(d,e,a,null,null,m),i[a]=d,h.push(a)),b([a],c)):b.specified(a)?b([a],c):(g.push({name:a,req:b,onLoad:c}),require.attach(d,null,a,k,"script/cache"))):b([a],c)}})})(),define("bucketMap",["map","signals","order!jVectorMap","order!usa-en"],function(Map,signals){return Map.$extend({__init__:function(container,basemap){var self=this;this.$super(container,basemap),$.extend(this.options,{bucketFunction:this.$class.linearBucketFunction})},createLegend:function(){var self=this,minVal,maxVal,prevMinVal,prevMaxVal,displayMin,displayMax;this.legendContainer.empty();var innerLegendContainer=$('<span style="display: inline-block; text-align:center;"></span>').appendTo(this.legendContainer);this.options.legendTitle&&($('<span class="map_legend_title">'+this.options.legendTitle+"</span>").appendTo(innerLegendContainer),$("<br />").appendTo(innerLegendContainer)),$.each(this.buckets,function(index,bucket){var markerContainer=$('<span class="marker_container"></span>');return $('<span class="map_legend_marker"></span>').appendTo(markerContainer).css("background-color",self.$class.palette[index]).after("<span>"+(bucket.label?bucket.label:self.$class.defaultLegendLabelFunction.call(self,bucket))+"</span>"),markerContainer.appendTo(innerLegendContainer),!0});var markerContainer=$('<span class="marker_container"></span>');$('<span class="map_legend_marker"></span>').appendTo(markerContainer).css("background-color","#CCC").after("<span>Value is not available</span>"),markerContainer.appendTo(innerLegendContainer)},assignColors:function(){this.buckets=this.options.bucketFunction.call(this,this.counts,this.$class.palette);var ret=[],state,count,bucket,ratio;for(var i=0;i<this.counts.length;i++)for(state in this.counts[i]){count=parseFloat(Highcharts.numberFormat(this.counts[i][state],this.options.dataPrecision,".",""));for(var j=0;j<this.buckets.length;j++)this.buckets[j].testValue&&typeof this.buckets[j].testValue=="function"?this.buckets[j].testValue(count)&&(ret[i]||(ret[i]={}),ret[i][state]=this.$class.palette[j]):this.$class.defaultBucketTestFunction.call(this.buckets[j],count)&&(ret[i]||(ret[i]={}),ret[i][state]=this.$class.palette[j])}this.colors=ret},__classvars__:{linearBucketFunction:function(counts,palette){var ret=[],state,step=(this.max-this.min)/palette.length;for(var i=0;i<palette.length;i++){var bucket={min:null,max:null};bucket.min=parseFloat(Highcharts.numberFormat(this.min+step*i,this.options.dataPrecision,".","")),bucket.min=i==0?bucket.min:bucket.min+1/Math.pow(10,this.options.dataPrecision),bucket.max=parseFloat(Highcharts.numberFormat(this.min+step*(i+1),this.options.dataPrecision,".","")),bucket.max=bucket.max<bucket.min?bucket.min:bucket.max,bucket.mid=(bucket.max-bucket.min)/2+bucket.min,(ret.length==0||bucket.min!=ret[ret.length-1].min||bucket.max!=ret[ret.length-1].max)&&!isNaN(bucket.min)&&!isNaN(bucket.max)&&ret.push(bucket);if(bucket.max>=this.max)break}return ret},defaultBucketTestFunction:function(val){return this.min&&this.max?val>=this.min&&val<=this.max:this.min?val>=this.min:this.max?val<=this.max:!1},defaultLegendLabelFunction:function(bucket){var displayMin,displayMax;return this.options.legendItemFormatter?(displayMin=self.options.legendItemFormatter.call(self,bucket.min),displayMax=self.options.legendItemFormatter.call(self,bucket.max)):(displayMin=bucket.min,displayMax=bucket.max),displayMin+(bucket.min<bucket.max?" to "+displayMax:"")}}})})