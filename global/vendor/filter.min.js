var TP=TP||{};TP.Entertainment=TP.Entertainment||{};(function(){var a=TP;var b=a.Entertainment;b.vars={};b.utils={addOversizeFilter:function(){var d,f,c,e,g;b.oversize=$('<div class="oversize-filter"></div>');d=$('<span class="selected"></span>');f=$("<ol></ol>").addClass("oversize-list");$("option",b.select).each(function(){c=$(this);e=$("<li></li>");if(c.attr("selected")){e.attr("data-selected",c.attr("selected"));e.addClass("selected");d.text(c.text())}e.attr("data-value",c.attr("value"));e.text(c.text());f.append(e)});b.oversize.bind("mousedown",function(h){b.utils.bindDocumentListener()});d.bind("click",function(){b.oversize.toggleClass("open")});f.bind("click",function(h){g=$(h.target).closest("li");if(g.length){b.utils.triggerSelected(g,d)}});b.oversize.insertAfter(b.select);b.oversize.append(d);b.oversize.append(f);b.oversize.append(b.select);b.form.find(":submit").remove()},closeOversizeFilter:function(){b.oversize.removeClass("open")},bindDocumentListener:function(){var c;b.documentListener=b.documentListener||function(d){c=$(d.target).closest(".oversize-filter");if(!c.length){b.utils.closeOversizeFilter();b.utils.unbindDocumentListener()}};$(document).bind("click",b.documentListener)},unbindDocumentListener:function(){$(document).unbind("click",b.documentListener)},triggerSelected:function(d,c){d.siblings().removeClass("selected");d.addClass("selected");c.text(d.text());b.select.val(d.attr("data-value"));b.select.trigger("change");b.utils.closeOversizeFilter()},addCloseButton:function(c){var d=$('<div class="close"></div>').bind("click",b.utils.closeActiveItem).appendTo(c);c.data("close",d)},closeActiveItem:function(c){c.preventDefault();c.stopPropagation();$(this).parent().removeClass("active");b.utils.refreshIsotope()},initializeIsotope:function(){b.list.isotope({itemSelector:"[data-type]",animationEngine:"best-availabie",resizable:false,masonry:{columnWidth:b.items.first().outerWidth(true)+1}})},filterIsotope:function(c){b.list.isotope({filter:c})},refreshIsotope:function(){b.list.isotope("reLayout",function(){var c=b.vars.activeElement,e=$(window),d=$("body"),f;b.vars.scrollTimer=window.setTimeout(function(){f=c.offset().top-15;d.animate({scrollTop:f},{duration:350})},1000)})}};b.init=function(){b.parent=$("#entertainment-filter");b.form=$("> form",b.parent);b.select=$("select",b.form);b.list=$("> ul",b.parent);b.items=$("> li",b.list)};b.activate=function(){var c;b.vars.offsetLeft=b.items.eq(3).position().left;b.vars.offsetHeight=b.items.height();b.items.bind("click",function(d){c=$(this);if(!c.hasClass("active")){d.preventDefault();d.stopPropagation();b.items.not(this).removeClass("active");b.vars.activeElement=c.addClass("active");if(!c.data("close")){b.utils.addCloseButton(c)}b.utils.refreshIsotope()}})};b.filter=function(){var c,d;b.select.bind("change",function(){c=$(this);d=c.val();b.utils.filterIsotope((d==="all")?"*":"[data-type='"+d+"']")});b.utils.addOversizeFilter()};b.layout=function(){b.utils.initializeIsotope()};a.utils.queue(b)}());