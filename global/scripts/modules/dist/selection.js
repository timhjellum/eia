/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

define("text",["module"],function(module){var text,fs,Cc,Ci,xpcIsWindows,progIds=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],xmlRegExp=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,bodyRegExp=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,hasLocation=typeof location!="undefined"&&location.href,defaultProtocol=hasLocation&&location.protocol&&location.protocol.replace(/\:/,""),defaultHostName=hasLocation&&location.hostname,defaultPort=hasLocation&&(location.port||undefined),buildMap={},masterConfig=module.config&&module.config()||{};text={version:"2.0.10",strip:function(content){if(content){content=content.replace(xmlRegExp,"");var matches=content.match(bodyRegExp);matches&&(content=matches[1])}else content="";return content},jsEscape:function(content){return content.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:masterConfig.createXhr||function(){var xhr,i,progId;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(i=0;i<3;i+=1){progId=progIds[i];try{xhr=new ActiveXObject(progId)}catch(e){}if(xhr){progIds=[progId];break}}return xhr},parseName:function(name){var modName,ext,temp,strip=!1,index=name.indexOf("."),isRelative=name.indexOf("./")===0||name.indexOf("../")===0;return index!==-1&&(!isRelative||index>1)?(modName=name.substring(0,index),ext=name.substring(index+1,name.length)):modName=name,temp=ext||modName,index=temp.indexOf("!"),index!==-1&&(strip=temp.substring(index+1)==="strip",temp=temp.substring(0,index),ext?ext=temp:modName=temp),{moduleName:modName,ext:ext,strip:strip}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(url,protocol,hostname,port){var uProtocol,uHostName,uPort,match=text.xdRegExp.exec(url);return match?(uProtocol=match[2],uHostName=match[3],uHostName=uHostName.split(":"),uPort=uHostName[1],uHostName=uHostName[0],(!uProtocol||uProtocol===protocol)&&(!uHostName||uHostName.toLowerCase()===hostname.toLowerCase())&&(!uPort&&!uHostName||uPort===port)):!0},finishLoad:function(name,strip,content,onLoad){content=strip?text.strip(content):content,masterConfig.isBuild&&(buildMap[name]=content),onLoad(content)},load:function(name,req,onLoad,config){if(config.isBuild&&!config.inlineText){onLoad();return}masterConfig.isBuild=config.isBuild;var parsed=text.parseName(name),nonStripName=parsed.moduleName+(parsed.ext?"."+parsed.ext:""),url=req.toUrl(nonStripName),useXhr=masterConfig.useXhr||text.useXhr;if(url.indexOf("empty:")===0){onLoad();return}!hasLocation||useXhr(url,defaultProtocol,defaultHostName,defaultPort)?text.get(url,function(content){text.finishLoad(name,parsed.strip,content,onLoad)},function(err){onLoad.error&&onLoad.error(err)}):req([nonStripName],function(content){text.finishLoad(parsed.moduleName+"."+parsed.ext,parsed.strip,content,onLoad)})},write:function(pluginName,moduleName,write,config){if(buildMap.hasOwnProperty(moduleName)){var content=text.jsEscape(buildMap[moduleName]);write.asModule(pluginName+"!"+moduleName,"define(function () { return '"+content+"';});\n")}},writeFile:function(pluginName,moduleName,req,write,config){var parsed=text.parseName(moduleName),extPart=parsed.ext?"."+parsed.ext:"",nonStripName=parsed.moduleName+extPart,fileName=req.toUrl(parsed.moduleName+extPart)+".js";text.load(nonStripName,req,function(value){var textWrite=function(contents){return write(fileName,contents)};textWrite.asModule=function(moduleName,contents){return write.asModule(moduleName,fileName,contents)},text.write(pluginName,nonStripName,textWrite,config)},config)}};if(masterConfig.env==="node"||!masterConfig.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])fs=require.nodeRequire("fs"),text.get=function(url,callback,errback){try{var file=fs.readFileSync(url,"utf8");file.indexOf("ï»¿")===0&&(file=file.substring(1)),callback(file)}catch(e){errback(e)}};else if(masterConfig.env==="xhr"||!masterConfig.env&&text.createXhr())text.get=function(url,callback,errback,headers){var xhr=text.createXhr(),header;xhr.open("GET",url,!0);if(headers)for(header in headers)headers.hasOwnProperty(header)&&xhr.setRequestHeader(header.toLowerCase(),headers[header]);masterConfig.onXhr&&masterConfig.onXhr(xhr,url),xhr.onreadystatechange=function(evt){var status,err;xhr.readyState===4&&(status=xhr.status,status>399&&status<600?(err=new Error(url+" HTTP status: "+status),err.xhr=xhr,errback(err)):callback(xhr.responseText),masterConfig.onXhrComplete&&masterConfig.onXhrComplete(xhr,url))},xhr.send(null)};else if(masterConfig.env==="rhino"||!masterConfig.env&&typeof Packages!="undefined"&&typeof java!="undefined")text.get=function(url,callback){var stringBuffer,line,encoding="utf-8",file=new java.io.File(url),lineSeparator=java.lang.System.getProperty("line.separator"),input=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file),encoding)),content="";try{stringBuffer=new java.lang.StringBuffer,line=input.readLine(),line&&line.length()&&line.charAt(0)===65279&&(line=line.substring(1)),line!==null&&stringBuffer.append(line);while((line=input.readLine())!==null)stringBuffer.append(lineSeparator),stringBuffer.append(line);content=String(stringBuffer.toString())}finally{input.close()}callback(content)};else if(masterConfig.env==="xpconnect"||!masterConfig.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)Cc=Components.classes,Ci=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),xpcIsWindows="@mozilla.org/windows-registry-key;1"in Cc,text.get=function(url,callback){var inStream,convertStream,fileObj,readData={};xpcIsWindows&&(url=url.replace(/\//g,"\\")),fileObj=new FileUtils.File(url);try{inStream=Cc["@mozilla.org/network/file-input-stream;1"].createInstance(Ci.nsIFileInputStream),inStream.init(fileObj,1,0,!1),convertStream=Cc["@mozilla.org/intl/converter-input-stream;1"].createInstance(Ci.nsIConverterInputStream),convertStream.init(inStream,"utf-8",inStream.available(),Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),convertStream.readString(inStream.available(),readData),convertStream.close(),inStream.close(),callback(readData.value)}catch(e){throw new Error((fileObj&&fileObj.path||"")+": "+e)}};return text}),define("text!/global/scripts/modules/src/selection/selection.html",[],function(){return'<div>\r	<span class="state_selection_label">Select state(s):</span>\r	<select id="stateSelection">\r		{{#BYSTATE}}\r			{{#HEADER}}\r				<optgroup id="{{ID}}" label="{{NAME}}">\r				{{#SUBITEMS}}\r					<option id="{{ID}}" value="{{ID}}">{{NAME}}</option>\r				{{/SUBITEMS}}\r				</optgroup>\r			{{/HEADER}}\r			{{^HEADER}}\r				<option id="{{ID}}" value="{{ID}}">{{NAME}}</option>\r			{{/HEADER}}\r		{{/BYSTATE}}\r	</select>\r</div>'}),define("text!/global/scripts/modules/src/selection/selection.css",[],function(){return".state_selection_label {display: inline-block; padding-right: 20px; padding-top: 3px;}\r/* UI Multiselect CSS */\r.ui-multiselect { padding:2px 0 2px 4px; text-align:left }\r.ui-multiselect span.ui-icon { float:right }\r.ui-multiselect-single .ui-multiselect-checkboxes input { position:absolute !important; top: auto !important; left:-9999px; }\r.ui-multiselect-single .ui-multiselect-checkboxes label { padding:5px !important }\r\r.ui-multiselect-header { margin-bottom:3px; padding:3px 0 3px 4px }\r.ui-multiselect-header ul { font-size:0.9em }\r.ui-multiselect-header ul li { float:left; padding:0 10px 0 0 }\r.ui-multiselect-header a { text-decoration:none }\r.ui-multiselect-header a:hover { text-decoration:underline }\r.ui-multiselect-header span.ui-icon { float:left }\r.ui-multiselect-header li.ui-multiselect-close { float:right; text-align:right; padding-right:0 }\r\r.ui-multiselect-menu { display:none; padding:3px; position:absolute; z-index:10000 }\r.ui-multiselect-checkboxes { position:relative /* fixes bug in IE6/7 */; overflow-y:scroll }\r.ui-multiselect-checkboxes label { cursor:default; display:block; border:1px solid transparent; padding:3px 1px }\r.ui-multiselect-checkboxes label input { position:relative; top:1px }\r.ui-multiselect-checkboxes li { clear:both; font-size:0.9em; padding-right:3px }\r.ui-multiselect-checkboxes li.ui-multiselect-optgroup-label { text-align:center; font-weight:bold; border-bottom:1px solid }\r.ui-multiselect-checkboxes li.ui-multiselect-optgroup-label a { display:block; padding:3px; margin:1px 0; text-decoration:none }\r\r/* remove label borders in IE6 because IE6 does not support transparency */\r* html .ui-multiselect-checkboxes label { border:none }"}),define("selection",["signals","classy","text!/global/scripts/modules/src/selection/selection.html","text!/global/scripts/modules/src/selection/selection.css","mustache","multiselect"],function(signals,Class,selectionTemplate,css){return Class.$extend({container:null,select:null,menuContents:null,selectionChanged:null,selectionClosed:null,sortBy:null,__init__:function(container){$("head").append("<style>"+css+"</style>");var self=this;this.container=container,this.selectionChanged=new signals.Signal,this.selectionClosed=new signals.Signal,$(this.container).on("click","a.sortChange",function(event){self.sortBy==self.$class.SORT_BY_STATE?self.update(self.menuContents,self.$class.SORT_BY_REGION,self.select.multiselect("getChecked").map(function(){return this.value}).get()):self.update(self.menuContents,self.$class.SORT_BY_STATE,self.select.multiselect("getChecked").map(function(){return this.value}).get())})},updateSelection:function(selected){var currChecked=this.select.multiselect("getChecked").map(function(){return this.value}).get();this.select.multiselect("widget").find(":checkbox").each(function(){($.inArray(this.value,selected)==-1&&$.inArray(this.value,currChecked)!=-1||$.inArray(this.value,selected)!=-1&&$.inArray(this.value,currChecked)==-1)&&this.click()})},update:function(menuContents,sortBy,selected){var self=this;this.menuContents=menuContents,this.sortBy=sortBy;var obj={};switch(sortBy){case this.$class.SORT_BY_STATE:obj[this.$class.SORT_BY_STATE]=this.menuContents[this.$class.SORT_BY_STATE],this.container.html(Mustache.render(selectionTemplate,obj));break;case this.$class.SORT_BY_REGION:default:obj[this.$class.SORT_BY_REGION]=this.menuContents[this.$class.SORT_BY_REGION],this.container.html(Mustache.render(selectionTemplate,obj))}var selectionChanged=function(event,ui){self.selectionChanged.dispatch({selected:self.select.multiselect("getChecked").map(function(){return this.value}).get()})};this.select=$(this.container).find("select").multiselect({selectedText:"# of # selected"}),this.updateSelection(selected),this.select.bind("multiselectclick",selectionChanged).bind("multiselectcheckall",selectionChanged).bind("multiselectuncheckall",selectionChanged).bind("multiselectoptgrouptoggle",selectionChanged).bind("multiselectclose",function(event,ui){self.selectionClosed.dispatch({selected:self.select.multiselect("getChecked").map(function(){return this.value}).get()})})},__classvars__:{SORT_BY_STATE:"BYSTATE",SORT_BY_REGION:"BYREGION"}})})