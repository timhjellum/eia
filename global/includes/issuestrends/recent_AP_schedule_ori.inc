<?phprequire_once 'global/includes/utils/utils.inc';
require_once 'global/includes/utils/Neic.inc';
$neic      = new NEIC();
?>
<?php
switch($l2page){
case 'page_pet':
$RAP = [
"",
"4728,5469,29772,32373,4729",
"4728,5469,29772,32373,4729",
"4728,5469,29772,32373,4729",
"4728,5469,29772,32373,4729",
"3975,4728,5469,29772,4729",
"3975,4728,5469,29772,4729",
"3975,4728,5469,29772,4729",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,29772,4729,41375",
"4728,5469,3804,4729,41375",
"4728,5469,3804,4729,41375",
"4728,5469,3804,4729,41375",
"4728,5469,3804,4729,41375",
"4728,5469,3804,4729,41375",
"4728,5469,3804,4729,41375",
"4728,5469,3804,4729,41375",
"4728,5469,3804,4729,41375",
"4728,5469,3804,4729,41375",
"4728,5469,3804,4729,41375",
"4728,5469,3804,4729,41375"
];
break;
case 'page_nat':
$RAP=[
"",
"3863,7025,5127,5469",
"3863,7025,5127,3862",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,512738795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,7025",
"3863,4699,5127,7025",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795",
"3863,4699,5127,38795"
];
break;
case 'page_coa':
$RAP = [
"",
"3864,4564,5570,7023",
"3864,4564,5570,7023",
"3864,4564,5570,7023",
"3864,4564,5570,7023",
"3864,4564,5570,7023",
"3864,4564,5570,7023",
"3864,4564,5570,7023",
"3864,4564,5570,7023",
"3864,4564,5570,7023",
"3864,4564,7020,7023",
"3864,4564,7020,7023",
"3864,4564,7020,7023",
"3864,4564,7020,7023",
"3864,4564,7020,7023",
"3864,4564,7020,7023",
"3864,4564,7020,7023",
"3864,4564,7020,7023",
"3864,4564,7020,7023",
"3864,4564,7020,7023",
"3864,4564,7020,7023",
"3864,4564,7020,7023",
"3864,4564,5570,4008",
"3864,4564,5570,4008",
"3864,4564,5570,4008",
"3864,4564,5570,4008",
"3864,4564,5570,4008",
"3864,4564,5570,4420",
"3864,4564,5570,4420",
"3864,4564,5570,4420",
"3864,4564,5570,4420",
"3864,4564,5570,4420"
];
break;
case 'page_ele':
$RAP = [
"",
"5073,5247,7009,30773",
"5073,5247,7009,30773",
"5073,5247,7009,30773",
"5073,5247,7009,30773",
"5073,5247,7009,30773",
"5073,5247,7009,30773",
"5073,5247,7009,30773",
"5073,5247,7009,30773",
"5073,5247,7010,30773",
"5073,5247,7010,30773",
"5073,5247,7010,30773",
"5073,5247,7010,7009",
"5073,5247,7010,7009",
"5073,5247,7010,7009",
"5073,5247,7010,7009",
"5073,5247,7010,38795",
"5073,5247,7010,38795",
"5073,5247,7010,38795",
"5073,5247,7010,38795",
"5073,5247,7010,38795",
"5073,5247,7010,38795",
"5073,5247,38795,7009",
"5073,5247,38795,7009",
"5073,5247,38795,7009",
"5073,5247,38795,7009",
"5073,5247,38795,7009",
"5073,5247,38795,7009",
"5073,5247,38795,5403",
"5073,5247,38795,5403",
"5073,5247,38795,5403",
"5073,5247,38795,5403"
];
break;
case 'page_con':
$RAP = [
"",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912",
"6927,7027,25967,28773,30912"
];
break;
case 'page_ren':
$RAP = [
"",
"7029,7031,5427,40094",
"7029,7031,5427,40094",
"7029,7031,5427,40094",
"7029,7031,5427,40094",
"7029,7031,5427,40094",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820",
"7029,7031,5427,40094,4820"
];
break;
case 'page_nuc':
$RAP = [
"",
"5073,4726,5043,4620",
"5073,4726,5043,4620",
"5073,4726,5043,4620",
"5073,4726,5043,4620",
"5073,4726,5043,4380",
"5073,4726,5043,4380",
"5073,4726,5043,4380",
"5073,4726,5043,4380",
"5073,4726,5043,4380",
"5073,4726,5043,4380",
"5073,4726,5043,4380",
"5073,4726,5043,4380",
"6227,4726,5043,4380",
"6227,4726,5043,4380",
"6227,4726,5043,4380",
"6227,4726,5043,4380",
"6227,4726,5043,4380",
"6227,4726,5043,4380",
"6227,4726,5043,4380",
"6227,4380,5043,4380",
"6227,4380,5043,4380",
"6227,4380,5043,4380",
"6227,4380,5043,4380",
"6227,4380,5043,4380",
"6227,4380,5043,4380",
"6227,4380,5043,4380",
"5073,4380,5043,4380",
"5073,4380,5043,4380",
"5073,4380,5043,4380",
"5073,4380,5043,4380",
"5073,4380,5043,4380"
];
break;
case 'page_tot':
$RAP = [
"",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927",
"4726,5043,30773,6927"
];
break;
case 'page_ana':
$RAP = [
"",
"3887,3863,7107,6927",
"3887,3863,7107,6927",
"3887,3863,7107,6927",
"3887,3863,7107,6927",
"3887,5043,30412,6927",
"3863,5043,30412,6927",
"5043,30412,6927,32813",
"5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"32373,5043,30412,6927,32813",
"5043,32373,30834,6647,6927,32813",
"5043,32373,30834,6647,6927,32813",
"5043,32373,30834,6647,6927,32813",
"5043,32373,30834,6647,6927,32813",
"3887,32373,30834,6647,6927,32813",
"3887,32373,30834,6647,6927,32813",
"3887,32373,30834,6647,6927,32813",
"3887,32373,30834,6647,6927,32813",
"3887,32373,30834,6647,6927,32813",
"3887,32373,7107,6927,32813",
"3887,32373,7107,6927,32813"
];
break;
case 'page_fin':
$RAP = [
"",
"3863,5043,5127,8087",
"6687,26370,6387,3863,3887",
"6687,26370,6387,5043",
"6687,26370,6387,3863,3887",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,3863,3887",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,3863,3887",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,3863,3887",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,3863,3887",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,3863,3887",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,5043",
"6687,26370,6387,5043"
];
break;
case 'page_env':
$RAP = [
"",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293",
"4726,5043,6867,29293"
];
break;
}
$exploded   = explode(',',$RAP[date('j')]);
//print_r($exploded);
//hsh_sql:
//associated with query name recent_AP
$bindVariables = array();
$j = 0;
$tmp_v2 = '';
$qualifierArr = $exploded;
foreach($qualifierArr as $v1) {
$val = trim($v1);
if($val) {
if($tmp_v2 !== '')
$tmp_v2 .= ", :tmpKey_v1" . $j;
else
$tmp_v2 = " :tmpKey_v1" . $j;
$bindVariables[':tmpKey_v1' . $j] = $val;
$j++;
}
}
$neic->sql = " select
TITLE, RELEASE_DATE, PERIODICITY, HAS_ANALYSIS, HAS_DATA, HAS_FORECAST, LINK_HTML,
listagg(TAGID, ',') within group (order by tag asc) as reporttags,
listagg(TAG, ',') within group (order by tag asc) as reporttagnames
from (
select
distinct TITLE,
RELEASE_DATE,
PERIODICITY,
HAS_ANALYSIS,
HAS_DATA,
HAS_FORECAST,
LINK_HTML,
TAGID,
TAG
from NEIC.ARCHIVES_REPORT_LIST ar_list
inner join NEIC.ARCHIVES_REPORT_LU ar_lu
on ar_list.ID = ar_lu.ID
inner join NEIC.TAGS ar_tag
on ar_lu.TAGID = ar_tag.ID
where
ar_list.ID in ( " . $tmp_v2 . " )
and
ar_tag.ID <> :tag
)
group by TITLE, RELEASE_DATE, PERIODICITY, HAS_ANALYSIS, HAS_DATA, HAS_FORECAST, LINK_HTML
order by RELEASE_DATE desc
";
$bindVariables[":tag"] = $CorrespondingTag;
//print $neic->sql;
//print_r($bindVariables);
$recent_AP = $neic->get($bindVariables);
//print_r($recent_AP);
?>
<span class="side_col right">
<h1>Recent Analysis &amp; Projections</h1>
<ul class="analysis-projections">
<?php
foreach($recent_AP as $row) {
$DataTypesArray = [];
$filename = "";
if(strtolower($row['has_data']) == "y"){
$DataTypesArray[] = "Data";
$filename .= "d";
}
if(strtolower($row['has_analysis']) == "y"){
$DataTypesArray[] = "Analysis";
$filename .= "a";
}
if(strtolower($row['has_forecast']) == "y"){
$DataTypesArray[] = "Forecast";
$filename .= "p";
}
$TitleText = "Report Type";
if(count($DataTypesArray)>1)
$TitleText .= "s";
$TitleText .= ": ";
$count=count($DataTypesArray);
for($x=0;$x<$count;$x++){
$TitleText .= $DataTypesArray[$x];
if($x<$count-1)
$TitleText .= ", ";
}
echo '        <li>
<img src="/global/images/icons/dap/';
if(strtolower($row['has_data']) == "y") {
echo 'd';
}
if(strtolower($row['has_analysis']) == "y") {
echo 'a';
}
if(strtolower($row['has_forecast']) == "y") {
echo 'p';
}
echo '.png" title="' . $TitleText . '"/>';
echo PHP_EOL;
echo '<span>
<h3>';
echo PHP_EOL;
if(strlen($row['link_html']))
echo "<a href=\"".$row['link_html']."\">".$row['title']."</a>";
else
echo $row['title'];
echo PHP_EOL;
echo '</h3>';
echo PHP_EOL;
echo "<span class="date">Released ".date('F d, Y',strtotime($row['release_date']))."</span>";
echo PHP_EOL;
$thetags = $row['reporttags'];
$thetagnames = $row['reporttagnames'];
$thetitle = $row['title'];
$thelink = $row['link_html'];
include "it_displaytags.inc";
echo "</span>";
echo PHP_EOL;
echo "</li>";
echo PHP_EOL;
}
?>
</ul>
</div>        <li>
<a href="reports.cfm">
<strong>See more analysis & projections &rsaquo;</strong>
</a>
</p>